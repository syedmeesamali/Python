# CipherGAN

Implementation of CipherGAN, used to obtain the results detailed in [Unsupervised Cipher-Cracking Using Neural Networks](https://arxiv.org/abs/1801.04883).  
**Authors**: [Aidan N. Gomez](https://aidangomez.ca/), [Sīcōng Huang](https://www.linkedin.com/in/sicong-sheldon-huang/), [Ivan Zhang](https://ivanzhang.ca/), [Bryan M. Li](https://bryanli.io/), [Muhammad Osama](http://mcode.ca/), [Łukasz Kaiser](https://research.google.com/pubs/LukaszKaiser.html) 

## Citing this work
```
@inproceedings{
    n.2018unsupervised,
    title={Unsupervised Cipher Cracking Using Discrete {GAN}s},
    author={Aidan N. Gomez and Sicong Huang and Ivan Zhang and Bryan M. Li and Muhammad Osama and Lukasz Kaiser},
    booktitle={International Conference on Learning Representations},
    year={2018},
    url={https://openreview.net/forum?id=BkeqO7x0-},
}
```

## Running this code
Call `pip install -r CipherGAN/requirements.txt` to install all dependencies.

### Generating Data
We make use of data generators to generate the TFRecords that are used for training. Of particular note is [`cipher_generator`](data/data_generators/cipher_generator.py), which may be used to generate data for the shift and Vigenère ciphers that were tested in the paper.

#### Sample Call
The settings for the included generators are passed as flags. For example, to generate a word-level Vigenère Cipher (key:`CDE`) on the Brown Corpus with a sample length of 200, call:
```
python CipherGAN/data/data_generators/cipher_generator.py \
  --cipher=vigenere \
  --vigenere_key=345 \
  --percentage_training=0.9 \
  --corpus=brown \
  --vocab_size=200 \
  --test_name=vigenere345-brown200-eval \
  --train_name=vigenere345-brown200-train \
  --output_dir=tmp/data \
  --vocab_filename=vigenere345_brown200_vocab.txt
```

### Training
All training can be performed by calling [`train.py`](train.py). Training requires the TFRecords generated by the included generators.

#### Sample Call
Please refer to the flags accepted by [`train.py`](train.py) for a full set of options.
```
python -m CipherGAN.train \
  --output_dir=runs/vig345 \
  --test_name="vigenere345-brown200-eval*" \
  --train_name="vigenere345-brown200-train*" \
  --hparam_sets=vigenere_brown_vocab_200
```

## Contributing
We'd love to accept your contributions to this project. Please feel free to open an issue, or submit a pull request as necessary. If you have implementations of this repository in other ML frameworks, please reach out so we may highlight them here.

### Acknowledgements
Our thanks to [Michal Wiszniewski](https://github.com/wisznie) for his assistance in developing this codebase.  
In addition, this repository borrows and builds upon code from:
* [CycleGAN](https://github.com/hardikbansal/CycleGAN)
* [pix2pix-tensorflow](https://github.com/affinelayer/pix2pix-tensorflow)
* [GAN-tensorflow](https://github.com/ckmarkoh/GAN-tensorflow)

